{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Resumen · Calidad del Aire</title>

    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet"
    />
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
        rel="stylesheet"
    />

    <link href="{% static 'styles/styles.css' %}" rel="stylesheet" />

    <style>
        .initial-hidden {
            opacity: 0;
            transform: translateY(15px);
        }
    </style>
</head>
<body>
    {% include 'partials/navbar/navbar.html' %}

    <div
        class="content initial-hidden"
        id="main-content"
        style="opacity: 0; transition: opacity 1s ease-out, transform 1s ease-out"
    >
        <header
            class="py-5 mb-5 border-bottom text-center"
            style="border-color: #f2ead3 !important"
        >
            <div class="mx-auto" style="max-width: 800px">
                <span
                    class="nk-subtle text-uppercase fw-semibold mb-2 d-block tracking-widest"
                    style="font-family: 'Inter', sans-serif; color: #344f1f !important"
                >
                    Resultados del Modelo
                </span>
                <h1
                    class="display-3 fw-bolder mb-3"
                    style="font-family: 'Inter', sans-serif; letter-spacing: -2px"
                >
                    Resumen de Predicciones
                </h1>
                <p
                    class="lead text-muted mx-auto"
                    style="
                        max-width: 600px;
                        font-size: 1.25rem;
                        font-family: 'Inter', sans-serif;
                        color: #344f1f !important;
                    "
                >
                    Esta tabla muestra todos los registros generados por la
                    última ejecución del modelo.
                </p>
                <div class="mt-4 d-flex justify-content-center gap-3">
                    <a
                        class="btn btn-outline-secondary btn-lg rounded-pill"
                        href="{% url 'generador' %}"
                        style="color: #344f1f; border-color: #344f1f"
                    >
                        Volver a Generar Modelos
                    </a>
                </div>
            </div>
        </header>

        {% if error_msg %}
        <div 
            class="alert alert-danger mx-auto" 
            role="alert" 
            style="max-width: 800px; background-color: #f8d7da; border-color: #f5c2c7; color: #842029;"
        >
            <strong>Error:</strong> {{ error_msg }}
        </div>
        {% endif %}

        <div 
            class="card shadow-sm border-0" 
            style="background-color: #f9f5f0; border-color: #f2ead3 !important;"
        >
            <div class="card-body p-3 p-md-4">
                <h5 class="card-title fs-3 fw-bold mb-3" style="color: #344f1f;">
                    Vista Completa de Predicciones
                </h5>

                {% if table_rows %}
                <div class="table-responsive">
                    <table 
                        class="table table-striped table-hover align-middle" 
                        style="background-color: #fff;"
                    >
                        <thead class="table-light">
                            <tr>
                                {% for col in columns %}
                                <th scope="col">{{ col }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in table_rows %}
                            <tr>
                                {% for k, v in row.items %}
                                <td>{{ v }}</td>
                                {% endfor %}
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <div 
                    class="alert alert-warning text-center" 
                    role="alert"
                    style="background-color: #F2EAD3; border-color: #547792; color: #344F1F;"
                >
                    <strong>No hay datos para mostrar.</strong>
                    <hr>
                    <p class="mb-0">
                        Parece que el archivo <code>predicciones_PM2_5.csv</code> no
                        existe o está vacío.
                        <a href="{% url 'generador' %}" class="alert-link fw-bold"
                            >Ejecuta el generador</a
                        >
                        para crearlo.
                    </p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const content = document.getElementById("main-content");
            if (content) {
                setTimeout(() => {
                    content.style.opacity = 1;
                    content.style.transform = "translateY(0)";
                }, 100);
            }
        });
    </script>
</body>
</html>